{% extends 'layouts/navbar_sidebar.html' %} 

{% load static %}

{% block main_content %}
<!DOCTYPE html>
<html>
    <head></head>
    <body>
        <div class="header">
            <h3>CARGAR INFORMACION</h3>
        </div>
        <div class="dropdown">
            <select id="carrera" onchange="cambiarArchivo()">
                <option value="FORMATO_SIS_CURSOS-NOTAS.xlsx">Ingenieria de Sistema</option>
                <option value="FORMATO_TEL_CURSOS-NOTAS.xlsx">Ingenieria Telematica</option>
                <option value="FORMATO_IBQ_CURSOS-NOTAS.xlsx">Ingenieria Bioquimica</option>
                <!-- Agrega más opciones según las carreras que tengas -->
            </select>
        </div>
        <a id="descargar" href="{% static 'excel_format/FORMATO_SIS_CURSOS-NOTAS.xlsx' %}" download>
            <button class="download-button">Descargar Formato</button>
        </a>
        <script>
            function cambiarArchivo() {
                var carrera = document.getElementById('carrera').value;
                document.getElementById('descargar').href = "{% static 'excel_format/' %}" + carrera;
            }
        </script>
        <table>
            <tr>
                <th>#</th>
                <th>Nombre</th>
                <th>Peso</th>
                <th>Acción</th>
                <!-- Nueva columna para el botón de eliminar -->
            </tr>
        </table>
        <div class="upload-area">
            <form method="POST" enctype="multipart/form-data">
                {{form.as_p}}
                <div class="send"> {% csrf_token %} <button class="send-button">Enviar</button>
                </div>
                <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> {% if messages %} <script>
                    {
                        %
                        for message in messages %
                    }
                    Swal.fire({
                        icon: '{{ message.tags }}',
                        title: '{{ message }}',
                        showConfirmButton: true,
                        confirmButtonColor: '#3085d6',
                    }) {
                        % endfor %
                    }
                </script> {% endif %}
            </form>
        </div>
        <script>
            // Selecciona el input de archivo
            var fileInput = document.querySelector('input[type="file"]');
            // Maneja el evento de cambio del input
            fileInput.addEventListener('change', function() {
                // Selecciona el archivo subido
                var file = fileInput.files[0];
                // Selecciona la tabla
                var table = document.querySelector('table');
                // Crea una nueva fila y celdas
                var row = document.createElement('tr');
                var cell1 = document.createElement('td');
                var cell2 = document.createElement('td');
                var cell3 = document.createElement('td');
                var cell4 = document.createElement('td'); // Nueva celda para el botón de eliminar
                // Asigna los datos del archivo a las celdas
                cell1.textContent = table.rows.length; // Número de fila
                cell2.textContent = file.name; // Nombre del archivo
                cell3.textContent = file.size; // Tamaño del archivo
                // Crea un botón de eliminar y lo agrega a la cuarta celda
                var deleteButton = document.createElement('button');
                deleteButton.textContent = 'Eliminar';
                deleteButton.addEventListener('click', function() {
                    row.parentNode.removeChild(row);
                });
                cell4.appendChild(deleteButton);
                // Agrega las celdas a la fila
                row.appendChild(cell1);
                row.appendChild(cell2);
                row.appendChild(cell3);
                row.appendChild(cell4); // Agrega la celda del botón de eliminar a la fila
                // Agrega la fila a la tabla
                table.appendChild(row);
            });
        </script>
    </body>
</html> 
{% endblock %}